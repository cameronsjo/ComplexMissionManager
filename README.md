# Complex Mission Manager - 智能多级任务拆分和并行执行系统

- 版本: 1.0.0

一个强大的 Claude Code Plugin,能够自动将复杂任务拆分为可并行执行的任务组,并通过多级 Agent 协作高效完成。

## 作者

LostAbaddon
- Email: lostabaddon@gmail.com
- Website: https://lostabaddon.github.io/

## 功能特性

### 🎯 核心功能

- **智能任务拆分**: 自动分析复杂任务并拆分为可并行执行的任务组
- **多级 Agent 协作**: 三层 Agent 架构确保任务高效执行
- **并行任务执行**: 最大化利用并行能力,提升执行效率
- **自动 Git 分支管理**: 在 git 仓库中自动创建和切换到专用开发分支
- **完整执行日志**: WorkLog.md 记录完整的执行过程,便于追溯和调试

### 🏗️ 三层 Agent 架构

#### 任务规划器 (task-planner)
- 接收用户的复杂任务
- 分析任务依赖关系和资源冲突
- 拆分为可并行执行的任务组
- 并行启动多个任务执行管理器
- 汇总所有任务组的执行结果

#### 任务执行管理器 (task-manager)
- 接收并行任务组的详细信息
- 管理 Git 分支(auto_develop_YYYY_MM_DD)
- 创建和维护 WorkLog.md 执行日志
- 将任务拆分为原子性子任务
- 顺序调用子任务执行器完成各子任务
- 审查完成情况并生成执行简报

#### 子任务执行器 (task-executor)
- 执行具体的原子性子任务
- 在 WorkLog.md 中以"队员"身份记录过程
- 严格遵守工作目录约束
- 向任务执行管理器汇报结果

### 📋 任务拆分原则

#### 可以并行执行的任务
- ✅ 纯读取操作(文件读取、网络搜索、网页分析)
- ✅ 对不同文件夹的文件进行修改操作
- ✅ 完全独立且互不影响的任务

#### 不能并行执行的任务
- ❌ 可能修改同一文件的任务
- ❌ 存在明确依赖关系的任务
- ❌ 需要共享状态的任务

### 🔄 工作流程

```
用户提交复杂任务
        ↓
SubAgent A 分析并拆分为并行任务组
        ↓
并行启动多个 SubAgent B ────┬──── 任务组 1
                          ├──── 任务组 2
                          └──── 任务组 3
        ↓
每个 SubAgent B:
  1. 切换 Git 分支
  2. 创建 WorkLog.md
  3. 拆分子任务
  4. 顺序调用 SubAgent C ────┬──── 子任务 1
                            ├──── 子任务 2
                            └──── 子任务 3
  5. 审查并生成简报
        ↓
SubAgent A 汇总所有简报
        ↓
向用户报告执行结果
```

## 使用场景

### 场景 1: 信息收集和文档整理
```
用户: "帮我收集关于 AI 大模型的最新信息,同时整理项目文档"

拆分为:
- 任务组 1: AI 大模型信息收集(网络操作)
- 任务组 2: 项目文档整理(本地文件操作)
```

### 场景 2: 全栈网站开发
```
用户: "开发一个博客网站,包含前端和后端"

拆分为:
- 任务组 1: 后端开发(backend/ 目录)
- 任务组 2: 前端开发(frontend/ 目录)
```

### 场景 3: 多模块功能开发
```
用户: "添加用户认证、数据分析和通知系统三个功能模块"

拆分为:
- 任务组 1: 用户认证模块(auth/ 目录)
- 任务组 2: 数据分析模块(analytics/ 目录)
- 任务组 3: 通知系统(notifications/ 目录)
```

## 特色功能

### Git 分支自动管理

每个任务组会自动:
1. 检查工作目录是否为 git 仓库
2. 如果是,创建或切换到 `auto_develop_YYYY_MM_DD` 分支
3. 在该分支上执行所有操作
4. 如果不是 git 仓库,跳过分支操作继续执行

**注意**: 不会强制将非 git 目录初始化为仓库。

### WorkLog.md 对话机制

每个任务组都会生成 `WorkLog.md`,记录完整的执行过程:

```markdown
# 工作日志

**任务主题**: 开发用户认证模块
**开始时间**: 2025-11-03 14:30:00
**工作目录**: /path/to/project

---

## 任务详情
{详细的任务说明}

---

## 执行记录

### 队长: 任务开始
开始执行任务,准备拆分子任务。

### 队长: 子任务拆分完成
已将任务拆分为以下子任务:
1. 创建认证模块基础文件
2. 实现登录功能
3. 实现注册功能
...

### 队员: 开始执行子任务
{子任务执行过程}

### 队员: 子任务执行完成
{完成情况说明}

### 队长: 任务完成
所有子任务已执行完成,质量检查通过。
```

### 任务执行报告

执行完成后会生成结构化的报告:

```markdown
# 任务执行报告

## 总体情况
- 总任务组数: 3
- 成功完成: 3
- 部分完成: 0
- 执行失败: 0

## 各任务组详情

### 任务组 1: 用户认证模块开发
**状态**: 成功

**完成情况**:
- 创建了认证模块基础文件
- 实现了登录和注册功能
- 添加了 JWT 令牌验证

**产出**:
- auth/index.js
- auth/middleware.js
- auth/utils.js

---

{其他任务组...}
```

## 安装

将此 Plugin 复制到 Claude Code 的 plugins 目录:

```bash
cp -r ComplexMissionManager ~/.claude/plugins/
```

或添加到你的项目的 `.claude/plugins/` 目录。

## 配置

无需额外配置,安装后即可使用。

## 技术架构

### Agent 通信流程

```
task-planner (SubAgent A)
    ↓ (并行调用)
task-manager (SubAgent B) × N
    ↓ (顺序调用)
task-executor (SubAgent C) × M
```

## 最佳实践

### 1. 任务描述清晰

提供清晰详细的任务描述,包括:
- 具体目标
- 约束条件
- 预期产出
- 质量要求

### 2. 合理指定工作目录

- 为不同类型的任务指定不同的工作目录
- 避免多个任务操作同一目录的相同文件
- 使用绝对路径而非相对路径

### 3. 充分利用并行能力

- 识别可以并行执行的任务
- 将独立任务分离到不同任务组
- 避免强行拆分有依赖的任务

### 4. 查看执行日志

- 检查 WorkLog.md 了解详细执行过程
- 通过日志诊断问题
- 利用日志改进任务描述

## 注意事项

### ⚠️ Git 操作

- 只在确认是 git 仓库时才执行 git 操作
- 不会强制初始化非 git 目录
- 分支命名格式固定为 `auto_develop_YYYY_MM_DD`

### ⚠️ 文件操作

- SubAgent C 的所有写操作必须在指定工作目录下
- 读操作没有限制,可以访问任何位置
- 不要修改工作目录外的文件

### ⚠️ 任务拆分

- 不要过度拆分简单任务
- 单个任务也是有效的拆分结果
- 优先保证任务的独立性而非并行度

## 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

## 贡献

欢迎提交 Issue 和 Pull Request!

---

## Marketplace

本项目已上架至[自建 Marketplace](https://github.com/lostabaddon/CCMarketplace)，其中还会不断更新和上架更多 Plugin，敬请期待！

---

## 更新日志

### v1.0.0 (2025-11-03)
- 初始版本发布
- 实现三层 Agent 架构
- 支持任务并行拆分和执行
- 自动 Git 分支管理
- WorkLog.md 执行日志
